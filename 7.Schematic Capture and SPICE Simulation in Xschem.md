# Schematic Capture and SPICE Simulation in Xschem

A guide on how to save a schematic in Xschem and prepare it for simulation using SPICE directives.

---

## 1. Saving Your Schematic

1. Press `Ctrl + S` (or `Ctrl + C` then `Ctrl + S` depending on your setup).
2. Navigate to the directory where you want to save your design (e.g., your `designs` folder).
3. Give your file a name, such as:

```
EE351_Lab1.sch
```

The `.sch` extension indicates a schematic capture file. Once saved, your schematic capture is complete.

---

## 2. What is SPICE?

SPICE stands for **Simulation Program with Integrated Circuit Emphasis**. You can think of it as a language for IC simulation — a way to describe circuits using text, known as a **SPICE netlist**.

Even though Xschem uses graphical schematic capture (drag and drop components and wires), the simulator ultimately converts everything into a SPICE netlist (code) that the computer can understand.

---

## 3. Generating a SPICE Netlist

After schematic capture, Xschem generates a SPICE netlist. This netlist is then passed to a simulator such as **Ngspice**, which executes your instructions (analysis commands).

```
Schematic (.sch)  →  SPICE Netlist  →  Ngspice Simulation
```

---

## 4. SPICE Directives (Simulation Commands)

SPICE uses commands called **directives** to specify what type of analysis to run. These are written as text instructions inside Xschem — there is no GUI for simulation setup, so directives must be inserted and written manually.

| Directive | Analysis Type |
|-----------|---------------|
| `.dc`     | DC Analysis   |
| `.ac`     | AC Analysis   |
| `.tran`   | Transient Analysis |

---

## 5. Adding SPICE Directives in Xschem

Everything in Xschem is treated as an object. To add simulation commands:

1. Open the **component browser**.
2. Choose the **Xschem library** (not the PDK library, since directives are not fabricated devices).
3. Search for `code`. You will find two options:
   - `code.sym`
   - `code_shown.sym`

Both work the same way, but `code_shown.sym` is **recommended** because it displays the directive text directly on the schematic.

---

## 6. `code.sym` vs `code_shown.sym`

| Feature | `code_shown.sym` | `code.sym` |
|---|---|---|
| Displays SPICE commands on schematic | ✅ Yes | ❌ No (dashed lines only) |
| Easier to debug errors | ✅ Yes | ❌ No |
| Recommended for beginners | ✅ Yes | ❌ No |

---

## 7. Writing SPICE Commands

1. Place `code_shown.sym` on your schematic.
2. Double-click it.
3. Enter your SPICE directives inside the text field. Examples:

**Transient analysis:**
```
.tran 1n 100n
```

**DC sweep:**
```
.dc V1 0 5 0.1
```

This text becomes part of the SPICE netlist used by the simulator.

---

## Summary

| Step | Action |
|------|--------|
| Save | Use the `.sch` extension for your schematic file |
| Directives | Use `.tran`, `.dc`, `.ac` to define simulation type |
| Insert | Add directives via `code_shown.sym` from the Xschem library |
| Simulate | Xschem converts the schematic into a SPICE netlist for Ngspice |

Using `code_shown.sym` lets you see your simulation commands clearly, debug errors easily, and understand the full flow from schematic to netlist to simulation.